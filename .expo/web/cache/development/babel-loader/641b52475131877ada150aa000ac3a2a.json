{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState } from 'react';\nimport { withTheme, Appbar, TextInput, HelperText, Button } from 'react-native-paper';\nimport { Formik } from 'formik';\nimport * as yup from 'yup';\nimport { Dialog, ALERT_TYPE } from 'react-native-alert-notification';\nimport { supabase } from \"../../config/supabase\";\nimport Loader from \"../../comp/Loader\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nfunction RegisterScreen(_ref) {\n  var navigation = _ref.navigation,\n      theme = _ref.theme;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      loading = _useState2[0],\n      setLoading = _useState2[1];\n\n  var _useState3 = useState(true),\n      _useState4 = _slicedToArray(_useState3, 2),\n      hidePassword = _useState4[0],\n      setHidePassword = _useState4[1];\n\n  var onRegister = function () {\n    var _ref2 = _asyncToGenerator(function* (values) {\n      setLoading(true);\n\n      var _yield$supabase$auth$ = yield supabase.auth.signUp({\n        email: values.email,\n        password: values.password\n      }),\n          authData = _yield$supabase$auth$.data,\n          authError = _yield$supabase$auth$.error;\n\n      var _yield$supabase$from$ = yield supabase.from('peserta').insert({\n        auth_uid: authData.user.id,\n        nama: values.fullname,\n        telpon: values.phone,\n        tanggal_gabung: new Date()\n      }),\n          registerErr = _yield$supabase$from$.error;\n\n      if (!registerErr) {\n        Dialog.show({\n          type: ALERT_TYPE.SUCCESS,\n          title: 'Berhasil Mendaftarkan Akun, Silahkan login',\n          button: 'Ok'\n        });\n        yield navigation.navigate('LoginScreen');\n      } else {\n        Dialog.show({\n          type: ALERT_TYPE.WARNING,\n          title: error.message,\n          button: 'Ok'\n        });\n      }\n\n      setLoading(false);\n    });\n\n    return function onRegister(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return _jsxs(_Fragment, {\n    children: [_jsx(Appbar.Header, {\n      children: _jsx(Appbar.Content, {\n        title: \"LMS Register\"\n      })\n    }), _jsx(Loader, {\n      loading: loading\n    }), _jsx(Formik, {\n      initialValues: {\n        email: '',\n        password: ''\n      },\n      enableReinitialize: true,\n      validationSchema: yup.object().shape({\n        fullname: yup.string().required(),\n        phone: yup.number().required().positive(),\n        email: yup.string().email().required(),\n        password: yup.string().min(6).required()\n      }),\n      onSubmit: function onSubmit(values) {\n        return onRegister(values);\n      },\n      children: function children(_ref3) {\n        var handleSubmit = _ref3.handleSubmit,\n            handleBlur = _ref3.handleBlur,\n            handleChange = _ref3.handleChange,\n            values = _ref3.values,\n            errors = _ref3.errors,\n            touched = _ref3.touched,\n            isValid = _ref3.isValid;\n        return _jsxs(_Fragment, {\n          children: [_jsx(TextInput, {\n            label: \"Nama Lengkap\",\n            value: values.fullname,\n            onChangeText: handleChange('fullname'),\n            onBlur: handleBlur('fullname'),\n            error: errors.fullname ? true : false,\n            style: {\n              margin: 10\n            }\n          }), errors.fullname && _jsx(HelperText, {\n            type: \"error\",\n            children: errors.fullname\n          }), _jsx(TextInput, {\n            label: \"Nomor Telepon\",\n            value: values.phone,\n            onChangeText: handleChange('phone'),\n            onBlur: handleBlur('phone'),\n            error: errors.phone ? true : false,\n            style: {\n              margin: 10\n            }\n          }), errors.phone && _jsx(HelperText, {\n            type: \"error\",\n            children: errors.phone\n          }), _jsx(TextInput, {\n            label: \"Email\",\n            value: values.email,\n            onChangeText: handleChange('email'),\n            onBlur: handleBlur('email'),\n            error: errors.email ? true : false,\n            style: {\n              margin: 10\n            }\n          }), errors.email && _jsx(HelperText, {\n            type: \"error\",\n            children: errors.email\n          }), _jsx(TextInput, {\n            label: \"Password\",\n            value: values.password,\n            onChangeText: handleChange('password'),\n            onBlur: handleBlur('password'),\n            secureTextEntry: hidePassword,\n            error: errors.password ? true : false,\n            right: _jsx(TextInput.Icon, {\n              icon: hidePassword ? 'eye' : 'eye-off',\n              onPress: function onPress() {\n                return setHidePassword(!hidePassword);\n              }\n            }),\n            style: {\n              margin: 10\n            }\n          }), errors.password && _jsx(HelperText, {\n            type: \"error\",\n            children: errors.password\n          }), _jsx(Button, {\n            mode: \"contained\",\n            disabled: !isValid,\n            onPress: handleSubmit,\n            style: {\n              margin: 10\n            },\n            children: \"Register\"\n          })]\n        });\n      }\n    })]\n  });\n}\n\nexport default withTheme(RegisterScreen);","map":{"version":3,"names":["React","useState","withTheme","Appbar","TextInput","HelperText","Button","Formik","yup","Dialog","ALERT_TYPE","supabase","Loader","RegisterScreen","navigation","theme","loading","setLoading","hidePassword","setHidePassword","onRegister","values","auth","signUp","email","password","authData","data","authError","error","from","insert","auth_uid","user","id","nama","fullname","telpon","phone","tanggal_gabung","Date","registerErr","show","type","SUCCESS","title","button","navigate","WARNING","message","object","shape","string","required","number","positive","min","handleSubmit","handleBlur","handleChange","errors","touched","isValid","margin"],"sources":["/home/rahmatrians/Documents/lms-app/lms-app/app/screen/auth/RegisterScreen.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { withTheme, Appbar, TextInput, HelperText, Button } from 'react-native-paper';\nimport { Formik } from 'formik';\nimport * as yup from 'yup';\nimport { Dialog, ALERT_TYPE } from 'react-native-alert-notification';\n\nimport { supabase } from '../../config/supabase';\nimport Loader from '../../comp/Loader';\n\nfunction RegisterScreen({ navigation, theme }) {\n\tconst [loading, setLoading] = useState(false);\n\tconst [hidePassword, setHidePassword] = useState(true);\n\n\tconst onRegister = async (values) => {\n\t\tsetLoading(true)\n\n\t\tconst { data: authData, error: authError } = await supabase.auth.signUp({\n\t\t\temail: values.email,\n\t\t\tpassword: values.password,\n\t\t})\n\n\t\tconst { error: registerErr } = await supabase\n\t\t\t.from('peserta')\n\t\t\t.insert({ auth_uid: authData.user.id, nama: values.fullname, telpon: values.phone, tanggal_gabung: new Date() })\n\n\t\tif (!registerErr) {\n\t\t\tDialog.show({\n\t\t\t\ttype: ALERT_TYPE.SUCCESS,\n\t\t\t\ttitle: 'Berhasil Mendaftarkan Akun, Silahkan login',\n\t\t\t\tbutton: 'Ok',\n\t\t\t})\n\t\t\tawait navigation.navigate('LoginScreen');\n\t\t} else {\n\t\t\tDialog.show({\n\t\t\t\ttype: ALERT_TYPE.WARNING,\n\t\t\t\ttitle: error.message,\n\t\t\t\tbutton: 'Ok',\n\t\t\t})\n\t\t}\n\n\n\t\tsetLoading(false)\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<Appbar.Header>\n\t\t\t\t<Appbar.Content title=\"LMS Register\" />\n\t\t\t</Appbar.Header>\n\n\t\t\t<Loader loading={loading} />\n\n\t\t\t<Formik\n\t\t\t\tinitialValues={{\n\t\t\t\t\temail: '',\n\t\t\t\t\tpassword: ''\n\t\t\t\t}}\n\t\t\t\tenableReinitialize\n\t\t\t\tvalidationSchema={yup.object().shape({\n\t\t\t\t\tfullname: yup\n\t\t\t\t\t\t.string()\n\t\t\t\t\t\t.required(),\n\t\t\t\t\tphone: yup\n\t\t\t\t\t\t.number()\n\t\t\t\t\t\t.required()\n\t\t\t\t\t\t.positive(),\n\t\t\t\t\temail: yup\n\t\t\t\t\t\t.string()\n\t\t\t\t\t\t.email()\n\t\t\t\t\t\t.required(),\n\t\t\t\t\tpassword: yup\n\t\t\t\t\t\t.string()\n\t\t\t\t\t\t.min(6)\n\t\t\t\t\t\t.required(),\n\t\t\t\t})}\n\t\t\t\tonSubmit={values => onRegister(values)}\n\t\t\t>\n\t\t\t\t{({ handleSubmit, handleBlur, handleChange, values, errors, touched, isValid }) => (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\tlabel=\"Nama Lengkap\"\n\t\t\t\t\t\t\tvalue={values.fullname}\n\t\t\t\t\t\t\tonChangeText={handleChange('fullname')}\n\t\t\t\t\t\t\tonBlur={handleBlur('fullname')}\n\t\t\t\t\t\t\terror={errors.fullname ? true : false}\n\t\t\t\t\t\t\tstyle={{ margin: 10 }}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{errors.fullname && <HelperText type=\"error\">{errors.fullname}</HelperText>}\n\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\tlabel=\"Nomor Telepon\"\n\t\t\t\t\t\t\tvalue={values.phone}\n\t\t\t\t\t\t\tonChangeText={handleChange('phone')}\n\t\t\t\t\t\t\tonBlur={handleBlur('phone')}\n\t\t\t\t\t\t\terror={errors.phone ? true : false}\n\t\t\t\t\t\t\tstyle={{ margin: 10 }}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{errors.phone && <HelperText type=\"error\">{errors.phone}</HelperText>}\n\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\tlabel=\"Email\"\n\t\t\t\t\t\t\tvalue={values.email}\n\t\t\t\t\t\t\tonChangeText={handleChange('email')}\n\t\t\t\t\t\t\tonBlur={handleBlur('email')}\n\t\t\t\t\t\t\terror={errors.email ? true : false}\n\t\t\t\t\t\t\tstyle={{ margin: 10 }}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{errors.email && <HelperText type=\"error\">{errors.email}</HelperText>}\n\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\tlabel=\"Password\"\n\t\t\t\t\t\t\tvalue={values.password}\n\t\t\t\t\t\t\tonChangeText={handleChange('password')}\n\t\t\t\t\t\t\tonBlur={handleBlur('password')}\n\t\t\t\t\t\t\tsecureTextEntry={hidePassword}\n\t\t\t\t\t\t\terror={errors.password ? true : false}\n\t\t\t\t\t\t\tright={<TextInput.Icon icon={hidePassword ? 'eye' : 'eye-off'} onPress={() => setHidePassword(!hidePassword)} />}\n\t\t\t\t\t\t\tstyle={{ margin: 10 }}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{errors.password && <HelperText type=\"error\">{errors.password}</HelperText>}\n\t\t\t\t\t\t<Button mode=\"contained\" disabled={!isValid} onPress={handleSubmit} style={{ margin: 10 }}>Register</Button>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t</Formik>\n\t\t</>\n\t);\n}\n\nexport default withTheme(RegisterScreen)"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,QAAgC,OAAhC;AACA,SAASC,SAAT,EAAoBC,MAApB,EAA4BC,SAA5B,EAAuCC,UAAvC,EAAmDC,MAAnD,QAAiE,oBAAjE;AACA,SAASC,MAAT,QAAuB,QAAvB;AACA,OAAO,KAAKC,GAAZ,MAAqB,KAArB;AACA,SAASC,MAAT,EAAiBC,UAAjB,QAAmC,iCAAnC;AAEA,SAASC,QAAT;AACA,OAAOC,MAAP;;;;;AAEA,SAASC,cAAT,OAA+C;EAAA,IAArBC,UAAqB,QAArBA,UAAqB;EAAA,IAATC,KAAS,QAATA,KAAS;;EAC9C,gBAA8Bd,QAAQ,CAAC,KAAD,CAAtC;EAAA;EAAA,IAAOe,OAAP;EAAA,IAAgBC,UAAhB;;EACA,iBAAwChB,QAAQ,CAAC,IAAD,CAAhD;EAAA;EAAA,IAAOiB,YAAP;EAAA,IAAqBC,eAArB;;EAEA,IAAMC,UAAU;IAAA,8BAAG,WAAOC,MAAP,EAAkB;MACpCJ,UAAU,CAAC,IAAD,CAAV;;MAEA,kCAAmDN,QAAQ,CAACW,IAAT,CAAcC,MAAd,CAAqB;QACvEC,KAAK,EAAEH,MAAM,CAACG,KADyD;QAEvEC,QAAQ,EAAEJ,MAAM,CAACI;MAFsD,CAArB,CAAnD;MAAA,IAAcC,QAAd,yBAAQC,IAAR;MAAA,IAA+BC,SAA/B,yBAAwBC,KAAxB;;MAKA,kCAAqClB,QAAQ,CAC3CmB,IADmC,CAC9B,SAD8B,EAEnCC,MAFmC,CAE5B;QAAEC,QAAQ,EAAEN,QAAQ,CAACO,IAAT,CAAcC,EAA1B;QAA8BC,IAAI,EAAEd,MAAM,CAACe,QAA3C;QAAqDC,MAAM,EAAEhB,MAAM,CAACiB,KAApE;QAA2EC,cAAc,EAAE,IAAIC,IAAJ;MAA3F,CAF4B,CAArC;MAAA,IAAeC,WAAf,yBAAQZ,KAAR;;MAIA,IAAI,CAACY,WAAL,EAAkB;QACjBhC,MAAM,CAACiC,IAAP,CAAY;UACXC,IAAI,EAAEjC,UAAU,CAACkC,OADN;UAEXC,KAAK,EAAE,4CAFI;UAGXC,MAAM,EAAE;QAHG,CAAZ;QAKA,MAAMhC,UAAU,CAACiC,QAAX,CAAoB,aAApB,CAAN;MACA,CAPD,MAOO;QACNtC,MAAM,CAACiC,IAAP,CAAY;UACXC,IAAI,EAAEjC,UAAU,CAACsC,OADN;UAEXH,KAAK,EAAEhB,KAAK,CAACoB,OAFF;UAGXH,MAAM,EAAE;QAHG,CAAZ;MAKA;;MAGD7B,UAAU,CAAC,KAAD,CAAV;IACA,CA7Be;;IAAA,gBAAVG,UAAU;MAAA;IAAA;EAAA,GAAhB;;EA+BA,OACC;IAAA,WACC,KAAC,MAAD,CAAQ,MAAR;MAAA,UACC,KAAC,MAAD,CAAQ,OAAR;QAAgB,KAAK,EAAC;MAAtB;IADD,EADD,EAKC,KAAC,MAAD;MAAQ,OAAO,EAAEJ;IAAjB,EALD,EAOC,KAAC,MAAD;MACC,aAAa,EAAE;QACdQ,KAAK,EAAE,EADO;QAEdC,QAAQ,EAAE;MAFI,CADhB;MAKC,kBAAkB,MALnB;MAMC,gBAAgB,EAAEjB,GAAG,CAAC0C,MAAJ,GAAaC,KAAb,CAAmB;QACpCf,QAAQ,EAAE5B,GAAG,CACX4C,MADQ,GAERC,QAFQ,EAD0B;QAIpCf,KAAK,EAAE9B,GAAG,CACR8C,MADK,GAELD,QAFK,GAGLE,QAHK,EAJ6B;QAQpC/B,KAAK,EAAEhB,GAAG,CACR4C,MADK,GAEL5B,KAFK,GAGL6B,QAHK,EAR6B;QAYpC5B,QAAQ,EAAEjB,GAAG,CACX4C,MADQ,GAERI,GAFQ,CAEJ,CAFI,EAGRH,QAHQ;MAZ0B,CAAnB,CANnB;MAuBC,QAAQ,EAAE,kBAAAhC,MAAM;QAAA,OAAID,UAAU,CAACC,MAAD,CAAd;MAAA,CAvBjB;MAAA,UAyBE;QAAA,IAAGoC,YAAH,SAAGA,YAAH;QAAA,IAAiBC,UAAjB,SAAiBA,UAAjB;QAAA,IAA6BC,YAA7B,SAA6BA,YAA7B;QAAA,IAA2CtC,MAA3C,SAA2CA,MAA3C;QAAA,IAAmDuC,MAAnD,SAAmDA,MAAnD;QAAA,IAA2DC,OAA3D,SAA2DA,OAA3D;QAAA,IAAoEC,OAApE,SAAoEA,OAApE;QAAA,OACA;UAAA,WACC,KAAC,SAAD;YACC,KAAK,EAAC,cADP;YAEC,KAAK,EAAEzC,MAAM,CAACe,QAFf;YAGC,YAAY,EAAEuB,YAAY,CAAC,UAAD,CAH3B;YAIC,MAAM,EAAED,UAAU,CAAC,UAAD,CAJnB;YAKC,KAAK,EAAEE,MAAM,CAACxB,QAAP,GAAkB,IAAlB,GAAyB,KALjC;YAMC,KAAK,EAAE;cAAE2B,MAAM,EAAE;YAAV;UANR,EADD,EASEH,MAAM,CAACxB,QAAP,IAAmB,KAAC,UAAD;YAAY,IAAI,EAAC,OAAjB;YAAA,UAA0BwB,MAAM,CAACxB;UAAjC,EATrB,EAUC,KAAC,SAAD;YACC,KAAK,EAAC,eADP;YAEC,KAAK,EAAEf,MAAM,CAACiB,KAFf;YAGC,YAAY,EAAEqB,YAAY,CAAC,OAAD,CAH3B;YAIC,MAAM,EAAED,UAAU,CAAC,OAAD,CAJnB;YAKC,KAAK,EAAEE,MAAM,CAACtB,KAAP,GAAe,IAAf,GAAsB,KAL9B;YAMC,KAAK,EAAE;cAAEyB,MAAM,EAAE;YAAV;UANR,EAVD,EAkBEH,MAAM,CAACtB,KAAP,IAAgB,KAAC,UAAD;YAAY,IAAI,EAAC,OAAjB;YAAA,UAA0BsB,MAAM,CAACtB;UAAjC,EAlBlB,EAmBC,KAAC,SAAD;YACC,KAAK,EAAC,OADP;YAEC,KAAK,EAAEjB,MAAM,CAACG,KAFf;YAGC,YAAY,EAAEmC,YAAY,CAAC,OAAD,CAH3B;YAIC,MAAM,EAAED,UAAU,CAAC,OAAD,CAJnB;YAKC,KAAK,EAAEE,MAAM,CAACpC,KAAP,GAAe,IAAf,GAAsB,KAL9B;YAMC,KAAK,EAAE;cAAEuC,MAAM,EAAE;YAAV;UANR,EAnBD,EA2BEH,MAAM,CAACpC,KAAP,IAAgB,KAAC,UAAD;YAAY,IAAI,EAAC,OAAjB;YAAA,UAA0BoC,MAAM,CAACpC;UAAjC,EA3BlB,EA4BC,KAAC,SAAD;YACC,KAAK,EAAC,UADP;YAEC,KAAK,EAAEH,MAAM,CAACI,QAFf;YAGC,YAAY,EAAEkC,YAAY,CAAC,UAAD,CAH3B;YAIC,MAAM,EAAED,UAAU,CAAC,UAAD,CAJnB;YAKC,eAAe,EAAExC,YALlB;YAMC,KAAK,EAAE0C,MAAM,CAACnC,QAAP,GAAkB,IAAlB,GAAyB,KANjC;YAOC,KAAK,EAAE,KAAC,SAAD,CAAW,IAAX;cAAgB,IAAI,EAAEP,YAAY,GAAG,KAAH,GAAW,SAA7C;cAAwD,OAAO,EAAE;gBAAA,OAAMC,eAAe,CAAC,CAACD,YAAF,CAArB;cAAA;YAAjE,EAPR;YAQC,KAAK,EAAE;cAAE6C,MAAM,EAAE;YAAV;UARR,EA5BD,EAsCEH,MAAM,CAACnC,QAAP,IAAmB,KAAC,UAAD;YAAY,IAAI,EAAC,OAAjB;YAAA,UAA0BmC,MAAM,CAACnC;UAAjC,EAtCrB,EAuCC,KAAC,MAAD;YAAQ,IAAI,EAAC,WAAb;YAAyB,QAAQ,EAAE,CAACqC,OAApC;YAA6C,OAAO,EAAEL,YAAtD;YAAoE,KAAK,EAAE;cAAEM,MAAM,EAAE;YAAV,CAA3E;YAAA;UAAA,EAvCD;QAAA,EADA;MAAA;IAzBF,EAPD;EAAA,EADD;AA+EA;;AAED,eAAe7D,SAAS,CAACW,cAAD,CAAxB"},"metadata":{},"sourceType":"module"}