{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport * as queryString from 'query-string';\nimport fromEntries from \"./fromEntries\";\nimport validatePathConfig from \"./validatePathConfig\";\n\nvar getActiveRoute = function getActiveRoute(state) {\n  var route = typeof state.index === 'number' ? state.routes[state.index] : state.routes[state.routes.length - 1];\n\n  if (route.state) {\n    return getActiveRoute(route.state);\n  }\n\n  return route;\n};\n\nexport default function getPathFromState(state, options) {\n  if (state == null) {\n    throw Error(\"Got 'undefined' for the navigation state. You must pass a valid state object.\");\n  }\n\n  if (options) {\n    validatePathConfig(options);\n  }\n\n  var configs = options !== null && options !== void 0 && options.screens ? createNormalizedConfigs(options === null || options === void 0 ? void 0 : options.screens) : {};\n  var path = '/';\n  var current = state;\n  var allParams = {};\n\n  var _loop = function _loop() {\n    var index = typeof current.index === 'number' ? current.index : 0;\n    var route = current.routes[index];\n    var pattern = void 0;\n    var focusedParams = void 0;\n    var focusedRoute = getActiveRoute(state);\n    var currentOptions = configs;\n    var nestedRouteNames = [];\n    var hasNext = true;\n\n    while (route.name in currentOptions && hasNext) {\n      pattern = currentOptions[route.name].pattern;\n      nestedRouteNames.push(route.name);\n\n      if (route.params) {\n        (function () {\n          var stringify = (_currentOptions$route = currentOptions[route.name]) === null || _currentOptions$route === void 0 ? void 0 : _currentOptions$route.stringify;\n          var currentParams = fromEntries(Object.entries(route.params).map(function (_ref) {\n            var _ref3 = _slicedToArray(_ref, 2),\n                key = _ref3[0],\n                value = _ref3[1];\n\n            return [key, stringify !== null && stringify !== void 0 && stringify[key] ? stringify[key](value) : String(value)];\n          }));\n\n          if (pattern) {\n            Object.assign(allParams, currentParams);\n          }\n\n          if (focusedRoute === route) {\n            focusedParams = _objectSpread({}, currentParams);\n            (_pattern = pattern) === null || _pattern === void 0 ? void 0 : _pattern.split('/').filter(function (p) {\n              return p.startsWith(':');\n            }).forEach(function (p) {\n              var name = getParamName(p);\n\n              if (focusedParams) {\n                delete focusedParams[name];\n              }\n            });\n          }\n        })();\n      }\n\n      if (!currentOptions[route.name].screens || route.state === undefined) {\n        hasNext = false;\n      } else {\n        index = typeof route.state.index === 'number' ? route.state.index : route.state.routes.length - 1;\n        var nextRoute = route.state.routes[index];\n        var nestedConfig = currentOptions[route.name].screens;\n\n        if (nestedConfig && nextRoute.name in nestedConfig) {\n          route = nextRoute;\n          currentOptions = nestedConfig;\n        } else {\n          hasNext = false;\n        }\n      }\n    }\n\n    if (pattern === undefined) {\n      pattern = nestedRouteNames.join('/');\n    }\n\n    if (currentOptions[route.name] !== undefined) {\n      path += pattern.split('/').map(function (p) {\n        var name = getParamName(p);\n\n        if (p === '*') {\n          return route.name;\n        }\n\n        if (p.startsWith(':')) {\n          var value = allParams[name];\n\n          if (value === undefined && p.endsWith('?')) {\n            return '';\n          }\n\n          return encodeURIComponent(value);\n        }\n\n        return encodeURIComponent(p);\n      }).join('/');\n    } else {\n      path += encodeURIComponent(route.name);\n    }\n\n    if (!focusedParams) {\n      focusedParams = focusedRoute.params;\n    }\n\n    if (route.state) {\n      path += '/';\n    } else if (focusedParams) {\n      for (var param in focusedParams) {\n        if (focusedParams[param] === 'undefined') {\n          delete focusedParams[param];\n        }\n      }\n\n      var query = queryString.stringify(focusedParams, {\n        sort: false\n      });\n\n      if (query) {\n        path += \"?\" + query;\n      }\n    }\n\n    current = route.state;\n  };\n\n  while (current) {\n    var _currentOptions$route;\n\n    var _pattern;\n\n    _loop();\n  }\n\n  path = path.replace(/\\/+/g, '/');\n  path = path.length > 1 ? path.replace(/\\/$/, '') : path;\n  return path;\n}\n\nvar getParamName = function getParamName(pattern) {\n  return pattern.replace(/^:/, '').replace(/\\?$/, '');\n};\n\nvar joinPaths = function joinPaths() {\n  var _ref4;\n\n  for (var _len = arguments.length, paths = new Array(_len), _key = 0; _key < _len; _key++) {\n    paths[_key] = arguments[_key];\n  }\n\n  return (_ref4 = []).concat.apply(_ref4, _toConsumableArray(paths.map(function (p) {\n    return p.split('/');\n  }))).filter(Boolean).join('/');\n};\n\nvar createConfigItem = function createConfigItem(config, parentPattern) {\n  var _pattern2;\n\n  if (typeof config === 'string') {\n    var _pattern3 = parentPattern ? joinPaths(parentPattern, config) : config;\n\n    return {\n      pattern: _pattern3\n    };\n  }\n\n  var pattern;\n\n  if (config.exact && config.path === undefined) {\n    throw new Error(\"A 'path' needs to be specified when specifying 'exact: true'. If you don't want this screen in the URL, specify it as empty string, e.g. `path: ''`.\");\n  }\n\n  pattern = config.exact !== true ? joinPaths(parentPattern || '', config.path || '') : config.path || '';\n  var screens = config.screens ? createNormalizedConfigs(config.screens, pattern) : undefined;\n  return {\n    pattern: (_pattern2 = pattern) === null || _pattern2 === void 0 ? void 0 : _pattern2.split('/').filter(Boolean).join('/'),\n    stringify: config.stringify,\n    screens: screens\n  };\n};\n\nvar createNormalizedConfigs = function createNormalizedConfigs(options, pattern) {\n  return fromEntries(Object.entries(options).map(function (_ref2) {\n    var _ref5 = _slicedToArray(_ref2, 2),\n        name = _ref5[0],\n        c = _ref5[1];\n\n    var result = createConfigItem(c, pattern);\n    return [name, result];\n  }));\n};","map":{"version":3,"mappings":"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","names":["queryString","fromEntries","validatePathConfig","getActiveRoute","state","route","index","routes","length","getPathFromState","options","Error","configs","screens","createNormalizedConfigs","path","current","allParams","pattern","focusedParams","focusedRoute","currentOptions","nestedRouteNames","hasNext","name","push","params","stringify","_currentOptions$route","currentParams","Object","entries","map","_ref","key","value","String","assign","_pattern","split","filter","p","startsWith","forEach","getParamName","undefined","nextRoute","nestedConfig","join","endsWith","encodeURIComponent","param","query","sort","replace","joinPaths","paths","_key","arguments","concat","Boolean","createConfigItem","config","parentPattern","exact","_pattern2","_ref2","c","result"],"sourceRoot":"../../src","sources":["getPathFromState.tsx"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}